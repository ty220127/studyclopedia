<link rel="icon" href="icon.png">
<link rel="stylesheet" href="https://ty220127.github.io/studyclopedia/studycss.css"/>
<html>
<head>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
	MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });	
	MathJax.Hub.Config({ TeX: { Macros: {
		numref: ['\\href{https://ty220127.github.io/mathemaru/#1.html###2}{\\scriptsize\\sf[\\# #2]}',2],
		nr: ['^\\numref{#1}{#2}', 2],
		refeq: ['\\underset{\\hspace{-1mm}\\numref{#1}{#2}}{=}',2],
		refleq: ['\\underset{\\hspace{-1mm}\\numref{#1}{#2}}{\\leq}',2],
		refeqv: ['\\underset{\\hspace{-1mm}\\numref{#1}{#2}}{\\equiv}',2],
		reflr: ['\\underset{\\hspace{-0.5mm}\\numref{#1}{#2}}{\\Longleftrightarrow}',2],
		refr: ['\\underset{\\numref{#1}{#2}}{\\Longrightarrow}',2],
		bs: '\\boldsymbol', 
		bsqcu: '\\displaystyle\\bigsqcup', 
		bcu: '\\displaystyle\\bigcup', 
		bca: '\\displaystyle\\bigcap', 
		fraction: ['\\displaystyle\\frac{#1}{#2}', 2],
		limit: '\\displaystyle\\lim',
		sig: '\\displaystyle\\sum',
		cpl: '\\mathsf{c}',
		trp: '\\mathsf{T}',
		rd: '\\mathrm{d}',
		intgrl: '\\displaystyle\\int',
		twobytwo: ['\\left[\\begin{array}{cc} #1 & #2\\\\ #3 & #4\\end{array}\\right]', 4],
		choose: ['\\left(\\begin{array}{c} #1\\\\ #2\\end{array}\\right)', 2],
		ket: ['|{#1}\\rangle', 1],
		ketbra: ['|{#1}\\rangle\\hspace{-0.5mm}\\langle{#2}|',2],
		braket: ['\\langle #1 \\rangle',1],
	}}});
</script>
<script>
	const established = "2023/4/15"
	const updated = "2023/6/1"
	<!--document.title= ttl.replace( '<br>', '' ) + "｜STUDYCLOPEDIA"-->
	const sec1 = "Introduction"
	const sec2 = "Preliminaries"
	const sec3 = "Directivity of QWRWers"
	const sec4 = "Summary and Discussion"
	const sec5 = "Appx. A: Calculations of probabilities on QWRWs"
	const sec6 = "Appx. B: The 2-term moving variance of $r(n)$"
</script>
<style>
</style>
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">  
</head>

<body>
<script src="https://ty220127.github.io/studyclopedia/number.js"></script>
<script>
	const N = C20QB;
	document.title= ttls[N] + "｜STUDYCLOPEDIA";
</script>

<div class="header">
<a href="index.html">STUDYCLOPEDIA</a>
</div>

<div class="boxes">
<center><div id="ttlhead"><script>document.write(ttls[N])</script></div>
<p>Balthazar Casalé, Giuseppe Di Molfetta, Hachem Kadri, and Liva Ralaivola
<br>Quantum Machine Intelligence vol. 2, article no. 11 (2020). [<a id="doi">doi</a>] [<a id="axv">arXiv</a>] </p>
</center>
<hr>

<p style="text-align:right; margin-top:-0.1em; margin-bottom: -2em;">
Page No. <b><script>document.write(N)</script></b> &ensp;
<i class="fa fa-clock-o" aria-hidden="true"></i>&nbsp;<script>document.write(established)</script>&ensp;
<span class="fa fa-history" aria-hidden="true"></span>&nbsp;<script>document.write(updated)</script>
</p>
       
<center style="margin-top:3em;">
<table border="2" width="80%" cellpadding="5"><tbody><tr><td>
「最適腕識別 (Best-arm-identification; BAI)」という名で知られるバンディット問題の量子版を考える．まず，BAI問題の量子的モデルを提案する．本モデルでは，学習するエージェントと環境の両方が量子であると仮定する．次に，BAIを解くための，量子振幅増幅を基にしたアルゴリズムを提案する．そして，問題のあらゆる状況に対するアルゴリズムの挙動を形式的に解析する．特に，本モデルが最適解を古典の場合よりも2乗のオーダーで速く得られることを示す．
</td></tr></tbody></table>
</center>
<br><br>

<div class="section">2. Best arm identification</div>

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = ar6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>行動 $x\in X$ に対する報酬平均値
	<p>\begin{align}
		a_x = \sum_{y\in Y} \nu_x(y) f(x,\,y)
		\end{align}</p>
	<p>は行動 $x$ により報酬が得られる確率そのものである．</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
	<p>\begin{align}
		Y^{x}_j := \{y\in Y\,|\,f(x,\,y) = j\}
		\end{align}</p>
	<p>と定めると，$Y^{x}_0\cap Y^{x}_1 = \emptyset$ かつ $Y^{x}_0\cup Y^{x}_1 = Y$ であるから</p>
	<p>\begin{align}
		a_x &= \sum_{y\in Y} \nu_x(y)f(x,\,y)\\
			&= \sum_{y\in Y^{x}_0} \nu_x(y)f(x,\,y) + \sum_{y\in Y^{x}_1} \nu_x(y)f(x,\,y)\\
			&= \sum_{y\in Y^{x}_0} \nu_x(y)\cdot 0 + \sum_{y\in Y^{x}_1} \nu_x(y)\cdot 1\\
			&= \sum_{y\in Y^{x}_1} \nu_x(y).
		\end{align}</p>
	<p>これは，行動 $x$ に対して報酬が得られる環境 $y$ になる確率の総和である．</p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = Re6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>最適腕識別において，$T$ 回の環境への作用を行った後の平均リグレット $R_T$ とエラー確率 $e_T := 1- P_T(x^*)$ の関係は</p>
	<p>\begin{align}
		R_T \leq e_T.
		\end{align}</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
		<p>\begin{align}
			R_T &= \sum_{x\in X\backslash\{x^*\}}P_T(x)\varDelta_x \leq \sum_{x\in X\backslash\{x^*\}}P_T(x)\\
				&= 1- P_T(x^*) = e_T
			\end{align}</p>
		<p>以上まとめると，$R_T \leq e_T.$</p>
 	</div>
</details>
<details class="dtl">
	<summary>補足</summary>
	<div id="tx">
		<p>論文では等号は含まれていない（つまり，$R_T\lt e_T$ としてある）．等号が成立するのは，すべての $x\in X\backslash\{x^*\}$ に対して $\varDelta_x = 1$ となる場合であるが，確かにそんな状況を考えても最適腕識別の設定としては面白くない．ただし，あり得ないわけではないので，ここでは等号も含めた形としている．</p>
 	</div>
</details>
</div>
<br>

<div class="section">3. Quantum amplitude amplification</div>

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = Hd6</script>
<div class="def"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>$j\in\{0,\ 1\}$ に対し， $X$ の部分集合</p>
	<p>\begin{align}
		X_j = \{x\in X\,|\, f(x) = j\}
		\end{align}</p>
	<p>を定義する．また，$j\in\{0,\ 1\}$ に対して</p>
	<p>\begin{align}
		\DeclareMathOperator{\spn}{\mathrm{span}}
		\mathcal{H}_j = \spn\{\ket{x}\in\mathcal{H}\,|\, x\in X_j\}
		\end{align}</p>
	<p>を定める．</p>
</div>
</div>
<br>

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = Ho6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>$\mathcal{H}_0$ と $\mathcal{H}_1$ は互いに直交補空間の関係にある．</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = Ps6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>$\mathcal{H}$ 上の状態を表す単位ベクトルを</p>
	<p>\begin{align}
		\ket{\varPsi} = \sum_{x\in X} \alpha_x \ket{x}\ \ \left(\alpha_x\in \mathbb{C},\, \sum_{x\in X}|\alpha_x|^2 =1\right)
		\end{align}</p>
	<p>で表すとき，$p = \sum_{x\in X_1} |\alpha_x|^2$ を用いて</p>
	<p>\begin{align*}
		\ket{\varPsi_1} &= \fraction{1}{\sqrt{p}}\sum_{x\in X_1} \alpha_x\ket{x} \in \mathcal{H}_1,\\
		\ket{\varPsi_0} &= \fraction{1}{\sqrt{1-p}}\sum_{x\in X_0} \alpha_x\ket{x}\in \mathcal{H}_0
		\end{align*}</p>
	<p>と定めれば，$\ket{\varPsi_0},\ \ket{\varPsi_1}$ はそれぞれ単位ベクトルであり，</p>
	<p>\begin{align}
		\ket{\varPsi} = \sqrt{p}\ket{\varPsi_1} + \sqrt{1-p}\ket{\varPsi_0}
		\end{align}</p>
	<p>である．また，$\theta := \arcsin \sqrt{p}$ なる $\theta\in (0,\ \pi/2)$ が存在して</p>
	<p>\begin{align*}
		\ket{\varPsi} = \sin\theta \ket{\varPsi_1} + \cos\theta \ket{\varPsi_0}.
		\end{align*}</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
		<p>$\ket{\varPsi_1},\ \ket{\varPsi_0}$ のノルムは</p>
		<p>\begin{align*}
			\|\ket{\varPsi_1}\|^2 &= \fraction{1}{p} \left\|\sum_{x\in X_1} \alpha_x\ket{x}\right\|^2 = \fraction{1}{p} \sum_{x\in X_1} |\alpha_x|^2 = 1,\Rule{0px}{0px}{40px}\\
			\|\ket{\varPsi_0}\|^2 &= \fraction{1}{1-p} \left\|\sum_{x\in X_0} \alpha_x\ket{x}\right\|^2 = \fraction{1}{1-p} \sum_{x\in X_0} |\alpha_x|^2\\
				&= \fraction{1}{1-p} \left( \sum_{x\in X} |\alpha_x|^2 -\sum_{x\in X_1} |\alpha_x|^2 \right) = \fraction{1-p}{1-p} = 1.
			\end{align*}</p>
		<p>よって，$\ket{\varPsi_1},\ \ket{\varPsi_0}$ は共に単位ベクトルである．また，これらを用いて</p>
		<p>\begin{align*}
			\ket{\varPsi} &= \sum_{x\in X}\alpha_x\ket{x} = \sum_{x\in X_1}\alpha_x\ket{x} + \sum_{x\in X_0} \alpha_x\ket{x} \\
				&= \sqrt{p} \cdot \fraction{1}{\sqrt{p}} \sum_{x\in X_1}\alpha_x\ket{x} + \sqrt{1-p} \cdot \fraction{1}{\sqrt{1-p}} \sum_{x\in X_0} \alpha_x\ket{x}\\
				&= \sqrt{p} \ket{\varPsi_1} + \sqrt{1-p} \ket{\varPsi_0}.
			\end{align*}</p>
		<p>ここで，$0\lt \sqrt{p}\lt 1$ であるから $\theta = \arcsin \sqrt{p}$ なる $\theta\in (0,\ \pi/2)$ が存在する．このとき $\sqrt{p} = \sin\theta,\ \sqrt{1-p} = \sqrt{1-\sin^2\theta} = \cos\theta$ であるから，$\theta$ を用いて $\ket{\varPsi}$ を以下のように書き換えられる：
	<p>\begin{align*}
		\ket{\varPsi} = \sin\theta \ket{\varPsi_1} + \cos\theta \ket{\varPsi_0}.
		\end{align*}</p>
	</div>
</details>
<details class="dtl">
	<summary>補足</summary>
	<div id="tx">
		<p>$p$ はマークされた要素のいずれかを観測する確率と解釈できる．振幅増幅における基本的な処理である．</p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = Of6</script>
<div class="def"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>関数 $f:X\to \{0,\,1\}$ に依存する作用素で，以下を満たすものを【オラクル (oracle)】と呼ぶ：</p>
	<p>\begin{align}
		O_f\ket{x} = (-1)^{f(x)}\ket{x}.
		\end{align}</p>
</div>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = kb6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>\begin{align}
		O_f = \mathbb{I} -2\sum_{x\in X_1}\ketbra{x}{x}.
		\end{align}</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
	<p>まず，$x\in X_1$ に対して<p>
	<p>\begin{align}
		O_f\ket{x} = (-1)^1\ket{x} = -\ket{x}.
		\end{align}</p>
	<p>次に，$x\in X_0$ に対して</p>
	<p>\begin{align}
		O_f\ket{x} = (-1)^0\ket{x} = \ket{x}.
		\end{align}</p>
	<p>よって</p>
	<p>\begin{align}
		O_f &= \sum_{x\in X_0}\ketbra{x}{x} - \sum_{x\in X_1}\ketbra{x}{x}\\
			&= \sum_{x\in X_0}\ketbra{x}{x} + \sum_{x\in X_1}\ketbra{x}{x} - \sum_{x\in X_1}\ketbra{x}{x} - \sum_{x\in X_1}\ketbra{x}{x}\\
			&= \sum_{x\in X}\ketbra{x}{x} -2\sum_{x\in X_1}\ketbra{x}{x}\\
			&= \mathbb{I} -2\sum_{x\in X_1}\ketbra{x}{x}
		\end{align}</p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = roD6</script>
<div class="def"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>状態 $\ket{\mathbf{0}} := \ket{0}^{\otimes n}$ を <script>nr(N,Ps6)</script> で導入した $\ket{\varPsi}$ に変換するユニタリ演算子を $A$ とする：</p>
	<p>\begin{align}
		\ket{\varPsi} = A\ket{\mathbf{0}}.
		\end{align}</p>
	<p>また $S_0  = 2 \ketbra{\mathbf{0}}{\mathbf{0}} - \mathbb{I}$ とし，これらを用いて演算子 $R_\varPsi$ を
	<p>\begin{align*}
		R_\varPsi = AS_0 A^{-1}
		\end{align*}</p>
	<p>と定義する．これを状態 $\ket{\varPsi}$ に関する【反射演算子 (reflection operator)】と呼ぶ．</p>
</div>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = roP6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>状態 $\ket{\varPsi}$ に関する反射演算子 $R_\varPsi$ は</p>
	<p>\begin{align*}
		R_\varPsi = 2\ketbra{\varPsi}{\varPsi} -\mathbb{I}
		\end{align*}</p>
	<p>と書き換えることができる．また，$R_\varPsi \ket{\varPsi} = \ket{\varPsi}$ が成立する．</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
		<p>演算子 $A$ はユニタリ，つまり $A^{-1} = A^\dagger$ である（ただし $A^\dagger$ は $A$ の随伴行列）ことを用いて，</p>
		<p>\begin{align*}
			R_\varPsi &= A(2\ketbra{\mathbf{0}}{\mathbf{0}} -\mathbb{I}) A^{-1} = 2 A\ketbra{\mathbf{0}}{\mathbf{0}}A^{-1} - AA^{-1}\\
				&= 2 A\ketbra{\mathbf{0}}{\mathbf{0}}A^\dagger - \mathbb{I} = 2 (A\ket{\mathbf{0}})(A\ket{\mathbf{0}})^\dagger - \mathbb{I}\\
				&= 2\ketbra{\varPsi}{\varPsi} -\mathbb{I}.
			\end{align*}</p>
		<p>$\ket{\varPsi}$ が単位ベクトルであることに注意して上の結果を用いると，</p>
		<p>\begin{align*}
			R_\varPsi \ket{\varPsi} &= (2\ketbra{\varPsi}{\varPsi} -\mathbb{I} ) \ket{\varPsi} = 2 \braket{\varPsi|\varPsi} \ket{\varPsi} - \ket{\varPsi} \\
				&= 2\ket{\varPsi} - \ket{\varPsi} = \ket{\varPsi}.
			\end{align*}</p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = aa6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>オラクル $O_f$ と状態 $\ket{\varPsi}$ に関する反射演算子 $R_\varPsi$ の積による演算子を $Q$ とする：</p>
	<p>\begin{align*}
			Q = R_\varPsi O_f.
		\end{align*}</p>
	<p><script>nr(N,Ps6)</script> で定義した $\ket{\varPsi_1},\ \ket{\varPsi_0}$ に対して</p>
	<p>\begin{align*}
			Q\ket{\varPsi_1} &= \cos 2\theta \,\ket{\varPsi_1} - \sin 2\theta \,\ket{\varPsi_0},\\
			Q\ket{\varPsi_0} &= \sin 2\theta \,\ket{\varPsi_1} + \cos 2\theta \,\ket{\varPsi_0}\\
		\end{align*}</p>
	<p>であり，故に $\ket{\varPsi}$ に対して</p>
	<p>\begin{align*}
			Q\ket{\varPsi} &= \sin 3\theta \,\ket{\varPsi_1} + \cos 3\theta \,\ket{\varPsi_0}
		\end{align*}</p>
	<p>である．更に，</p>
	<p>\begin{align*}
			Q^n \ket{\varPsi} &= \sin ((2n + 1)\theta) \,\ket{\varPsi_1} + \cos ((2n +1)\theta) \,\ket{\varPsi_0}
		\end{align*}</p>
	<p>である．</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
		<p></p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

<div class="section">4. Quantum best arm identification</div>

<!-- beginning of a box -->
<p id="1">&nbsp;</p><script>var curbox = rp6</script>
<div class="prp"><p style="border-left:5px solid transparent;"><script>nr(N,curbox)</script>&nbsp; <script>document.write(bns[N][curbox])</script></p>
<div id="tx">
	<p>QBAIにおいて要素 $x\in X$ が $n$ ステップの振幅増幅の後に推薦される確率 $P_n(x)$ は</p>
	<p>\begin{align}
		P_n(x) = |\alpha_x|^2 \left( 1 +  \fraction{(a_x -p)(\sin^2((2n+1)\theta)-p)}{p(1-p)}\right)
		\end{align}</p>
</div>
<details class="dtl">
	<summary>証明</summary>
	<div id="tx">
	<p>以下，$s = \sin((2n+1)\theta),\ c = \cos((2n+1)\theta)$ とする．</p>
	<p>\begin{align}
		P_n(x) &= \left\|\sum_{y\in Y}\ketbra{xy}{xy}\cdot G^n\ket{\varPsi}\right\|^2\\
			&= \left\| \sum_{y\in Y_1^{x}}\braket{xy|G^n|\varPsi}\ket{xy} + \sum_{y\in Y_0^{x}}\braket{xy|G^n|\varPsi}\ket{xy}\right\|^2\\
			&= \sum_{y\in Y_1^{x}}|\braket{xy|G^n|\varPsi}|^2 + \sum_{y\in Y_0^{x}}|\braket{xy|G^n|\varPsi}|^2\\
			&= \sum_{y\in Y_1^{x}}s^2\fraction{|\alpha_x|^2\nu_x(y)}{p} + \sum_{y\in Y_0^{x}}c^2\fraction{|\alpha_x|^2\nu_x(y)}{1-p}\\
			&= |\alpha_x|^2\left( \fraction{s^2}{p}\sum_{y\in Y_1^{x}}\nu_x(y) + \fraction{c^2}{1-p}\sum_{y\in Y_0^{x}}	\nu_x(y)\right) \\
			&= |\alpha_x|^2\left( \fraction{s^2}{p}a_x + \fraction{c^2}{1-p}(1-a_x)\right) \\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(s^2a_x(1-p) + c^2(1-a_x)p)\\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(s^2a_x + (1-s^2)p -a_x p)\\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(a_xs^2+ p c^2 -a_x p)\\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(a_xs^2+ p - ps^2 -a_x p)\\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(p -p^2 +a_xs^2- ps^2 -a_x p + p^2)\\
			&= \fraction{|\alpha_x|^2}{p(1-p)}(p(1-p) +(a_x- p)(s^2 -p))\\
			&= |\alpha_x|^2\left(1 +\fraction{(a_x- p)(s^2 -p)}{p(1-p)}\right).
		\end{align}</p>
 	</div>
</details>
</div>
<br>
<!-- end of a box -->

</div>

<br>
<div class="footer"></div>

<body>
</html>

<script>
const doitar = document.getElementById("doi");
doitar.href = doi[N];

const axvtar = document.getElementById("axv");
axvtar.href = arxiv[N];
</script>
